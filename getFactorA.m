function A = getFactorA(Do_t, L_Do, plotFlag)

if nargin<3
    plotFlag = false;
end

if Do_t > 400 || Do_t<150
    error('FactorA: please fill the table with more values.')
end


Do_t_150 = ...
[0.05, 0.338e-01;
0.06, 0.244e-01;
0.08, 0.151e-01;
0.10, 0.108e-01;
0.12, 0.833e-02;
0.16, 0.569e-02;
0.2, 0.431e-02;
0.4, 0.194e-02;
0.6, 0.125e-2;
1.0, 0.726e-3;
2.0, 0.349e-3;
4.0, 0.168e-3;
6.0, 0.108e-3;
8.0, 0.787e-4;
10.0, 0.619e-4;
12.0, 0.553e-4;
16.0, 0.510e-4;
20.0, 0.498e-4;
40.0, 0.489e-4;
50.0, 0.489e-4];

Do_t_200 =...
[0.05, 0.196e-01;
0.06, 0.143e-01;
0.08, 0.909e-02;
0.10, 0.659e-02;
0.14, 0.421e-02;
0.2, 0.272e-02;
0.3, 0.171e-02;
0.5, 0.976e-03;
0.8, 0.592e-03;
1.0, 0.469e-03;
2.0, 0.227e-03;
4.0, 0.110e-03;
6.0, 0.711e-04;
8.0, 0.520e-04;
10.0, 0.403e-04;
12.0, 0.338e-04;
14.0, 0.309e-04;
16.0, 0.295e-04;
20.0, 0.283e-04;
40.0, 0.275e-04;
50.0, 0.275e-04];


Do_t_250 = ...
[0.05, 0.129e-01;
0.06, 0.955e-02;
0.08, 0.617e-02;
0.10, 0.452e-02;
0.14, 0.293e-02;
0.2, 0.191e-02;
0.4, 0.881e-03;
0.6, 0.572e-03;
0.8, 0.422e-03;
1.0, 0.335e-03;
2.0, 0.163e-03;
4.0, 0.789e-04;
6.0, 0.513e-04;
8.0, 0.377e-04;
10.0, 0.293e-04;
12.0, 0.238e-04;
14.0, 0.210e-04;
16.0, 0.196e-04;
20.0, 0.184e-04;
40.0, 0.176e-04;
50.0, 0.176e-04];

Do_t_300 = ...
[0.05, 0.923e-02;
0.06, 0.690e-02;
0.08, 0.452e-02;
0.10, 0.334e-02;
0.12, 0.264e-02;
0.2, 0.143e-02;
0.4, 0.666e-03;
0.6, 0.433e-03;
0.8, 0.321e-03;
1.0, 0.254e-03;
2.0, 0.124e-03;
4.0, 0.602e-04;
6.0, 0.393e-04;
8.0, 0.287e-04;
10.0, 0.225e-04;
14.0, 0.156e-04;
16.0, 0.142e-04;
20.0, 0.130e-04;
40.0, 0.123e-04;
50.0, 0.122e-04];

Do_t_400 = ...
[0.05, 0.549e-02;
0.06, 0.417e-02;
0.08, 0.278e-02;
0.10, 0.208e-02;
0.12, 0.166e-02;
0.16, 0.118e-02;
0.2, 0.914e-03;
0.4, 0.429e-03;
0.6, 0.280e-03;
0.8, 0.207e-03;
1.0, 0.165e-03;
2.0, 0.808e-04;
4.0, 0.393e-04;
6.0, 0.257e-04;
8.0, 0.189e-04;
10.0, 0.148e-04;
14.0, 0.102e-04;
16.0, 0.882e-05];

Do_t_tables = {Do_t_150, Do_t_200, Do_t_250, Do_t_300, Do_t_400};
Do_t_list = [150, 200, 250, 300, 400];

Do_t_id_low = find(Do_t_list - Do_t>=0, 1, 'first');
Do_t_id_high = find(Do_t_list - Do_t<0, 1, 'last');
alpha = (Do_t - Do_t_list(Do_t_id_low))/(Do_t_list(Do_t_id_high) - Do_t_list(Do_t_id_low));

Alow = interp1(Do_t_tables{Do_t_id_low}(:,1), Do_t_tables{Do_t_id_low}(:,2), L_Do, 'linear', NaN);
Ahigh = interp1(Do_t_tables{Do_t_id_high}(:,1), Do_t_tables{Do_t_id_high}(:,2), L_Do, 'linear', NaN);
A = Alow + alpha*(Ahigh - Alow);

if plotFlag
    figure('NumberTitle', 'off', 'Name', 'Factor A');
    leg = cell(1, length(Do_t_tables) + 1);
    for tb_sel = 1:length(Do_t_tables)
        leg{tb_sel} = num2str(Do_t_list(tb_sel));
        loglog(Do_t_tables{tb_sel}(:,2), Do_t_tables{tb_sel}(:,1), 'Marker', 'x');
        hold on; grid on;
    end
    leg{length(Do_t_tables) + 1} = 'Picked Point';
    loglog(A, L_Do, 'ko');
    legend(leg);
    ylabel('L/Do')
    xlabel('A')
end


end

