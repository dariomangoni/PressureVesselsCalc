function [betaF, betaV, phi] = getFlangeParameters(g1, g0, h, l0, v, make_plot)

if nargin<6
    make_plot = false;
end


if make_plot
    figure('NumberTitle', 'off', 'Name', 'Flange Parameters');
    h_l0_range = linspace(0.1, 2.0, 10);
    g1_g0_range = linspace(1, 5, 50);
    A_range = g1_g0_range - 1;
    for hl_sel = 1:numel(h_l0_range)
        C_temp = 48 .* (1 - v.^2) .* (h_l0_range(hl_sel) ./ l0).^4;
        [betaF, betaV, phi] = getFlangeParametersInternal(A_range, C_temp, v);
        subplot(3,1,1);
        semilogx(g1_g0_range, betaF);
        hold on; grid on;
        subplot(3,1,2);
        semilogx(g1_g0_range, betaV);
        hold on; grid on;
        subplot(3,1,3);
        loglog(g1_g0_range, phi);
        hold on; grid on;
    end
    subplot(3,1,1); title('\beta_F');
    subplot(3,1,2); title('\beta_V');
    subplot(3,1,3); title('\phi');
end

disp(['g1/g0: ', num2str(g1/g0)])
disp(['h/l0: ', num2str(h/l0)])

betaF = input('Pick betaF from Figure 11.5-4: ');
betaV = input('Pick betaV from Figure 11.5-5: ');
phi = input('Pick phi from Figure 11.5-6: ');

% % % ASME
% % A = (g1 / g0) - 1;
% % C = 43.68 * (h / l0)^4;


% % % UNI
% A = g1./g0 - 1;
% C = 48 .* (1 - v.^2) .* (h ./ l0).^4;
% 
% 
% 
% [betaF, betaV, phi] = getFlangeParametersInternal(A, C, v);


end


function [betaF, betaV, phi] = getFlangeParametersInternal(A, C, v)

if A <= 1e-5
    betaF = 0.908920;
    betaV = 0.550103;
    phi = 1;
    return
end


% 
% %% BY DEEPSEEK (ASME)
% C1 = 1./3 + A./12;
% C2 = 5./42 + 17.*A./336;
% C3 = 1./210 + A./360;
% C4 = 11./360 + 59.*A./5040 + (1 + 3.*A)./C;
% C5 = 1./90 + 5.*A./1008 - (1 + A).^3./C;
% C6 = 1./120 + 17.*A./5040 + 1./C;
% C7 = 215./2772 + 51.*A./1232 + (60./7 + 225.*A./14 + 75.*A.^2./7 + 5.*A.^3./2)./C;
% C8 = 31./6930 + 128.*A./45045 + (6./7 + 15.*A./7 + 12.*A.^2./7 + 5.*A.^3./11)./C;
% C9 = 533./30240 + 653.*A./73920 + (1./2 + 33.*A./14 + 39.*A.^2./28 + 25.*A.^3./84)./C;
% C10 = 29./3780 + 3.*A./704 - (1./2 + 33.*A./14 + 81.*A.^2./28 + 13.*A.^3./12)./C;
% C11 = 31./6048 + 1763.*A./665280 + (1./2 + 6.*A./7 + 15.*A.^2./28 + 5.*A.^3./42)./C;
% C12 = 1./2925 + 71.*A./300300 + (8./35 + 18.*A./35 + 156.*A.^2./385 + 6.*A.^3./55)./C;
% C13 = 761./831600 + 937.*A./1663200 + (1./35 + 6.*A./35 + 11.*A.^2./70 + 3.*A.^3./70)./C;
% C14 = 197./415800 + 103.*A./332640 - (1./35 + 6.*A./35 + 17.*A.^2./70 + A.^3./10)./C;
% C15 = 233./831600 + 97.*A./554400 + (1./35 + 3.*A./35 + A.^2./14 + 2.*A.^3./105)./C;
% 
% C16 = C1 .* C7 .* C12 + C2 .* C8 .* C3 + C3 .* C8 .* C2 - (C3.^2 .* C7 + C8.^2 .* C1 + C2.^2 .* C12);
% 
% C17 = (C4 .* C7 .* C12 + C2 .* C8 .* C13 + C3 .* C8 .* C9 - (C13 .* C7 .* C3 + C8.^2 .* C4 + C12 .* C2 .* C9)) ./ C16;
% C18 = (C5 .* C7 .* C12 + C2 .* C8 .* C14 + C3 .* C8 .* C10 - (C14 .* C7 .* C3 + C8.^2 .* C5 + C12 .* C2 .* C10)) ./ C16;
% C19 = (C6 .* C7 .* C12 + C2 .* C8 .* C15 + C3 .* C8 .* C11 - (C15 .* C7 .* C3 + C8.^2 .* C6 + C12 .* C2 .* C11)) ./ C16;
% C20 = (C1 .* C9 .* C12 + C4 .* C8 .* C3 + C3 .* C13 .* C2 - (C3.^2 .* C9 + C13 .* C8 .* C1 + C12 .* C4 .* C2)) ./ C16;
% C21 = (C1 .* C10 .* C12 + C5 .* C8 .* C3 + C3 .* C14 .* C2 - (C3.^2 .* C10 + C14 .* C8 .* C1 + C12 .* C5 .* C2)) ./ C16;
% C22 = (C1 .* C11 .* C12 + C6 .* C8 .* C3 + C3 .* C15 .* C2 - (C3.^2 .* C11 + C15 .* C8 .* C1 + C12 .* C6 .* C2)) ./ C16;
% 
% C23 = (C1 .* C7 .* C13 + C2 .* C9 .* C3 + C4 .* C8 .* C2 - (C3 .* C7 .* C4 + C8 .* C9 .* C1 + C2.^2 .* C13)) ./ C16;
% C24 = (C1 .* C7 .* C14 + C2 .* C10 .* C3 + C5 .* C8 .* C2 - (C3 .* C7 .* C5 + C8 .* C10 .* C1 + C2.^2 .* C14)) ./ C16;
% C25 = (C1 .* C7 .* C15 + C2 .* C11 .* C3 + C6 .* C8 .* C2 - (C3 .* C7 .* C6 + C8 .* C11 .* C1 + C2.^2 .* C15)) ./ C16;
% 
% C26 = -(C ./ 4).^(1./4);
% C27 = C20 - C17 - 5./12 + C17 .* C26;
% C28 = C22 - C19 - 1./12 + C19 .* C26;
% C29 = -(C ./ 4).^(1./2);
% C30 = -(C ./ 4).^(3./4);
% C31 = 3 .* A ./ 2 - C17 .* C30;
% C32 = 1./2 - C19 .* C30;
% C33 = 0.5 .* C26 .* C32 + C28 .* C31 .* C29 - (0.5 .* C30 .* C28 + C32 .* C27 .* C29);
% C34 = 1./12 + C18 - C21 - C18 .* C26;
% C35 = -C18 .* (C ./ 4).^(3./4);
% C36 = (C28 .* C35 .* C29 - C32 .* C34 .* C29) ./ C33;
% C37 = (0.5 .* C26 .* C35 + C34 .* C31 .* C29 - (0.5 .* C30 .* C34 + C35 .* C27 .* C29)) ./ C33;
% 
% E1 = C17 .* C36 + C18 + C19 .* C37;
% E2 = C20 .* C36 + C21 + C22 .* C37;
% E3 = C23 .* C36 + C24 + C25 .* C37;
% E4 = 1./4 + C37./12 + C36./4 - E3./5 - 3.*E2./2 - E1;
% E5 = E1 .* (1./2 + A./6) + E2 .* (1./4 + 11*A./84) + E3 .* (1./70 + A./105);
% E6 = E5 - C36 .* (7./120 + A./36 + 3*A./C) - 1./40 - A./72 - C37 .* (1./60 + A./120 + 1./C);

%% BY DEEPSEEK (UNI)
% C1 = 1./3 + A ./ 12;
% C2 = 5./42 + 17 .* A ./ 336;
% C3 = 1./210 + A ./ 360;
% C4 = 11./360 + 59 .* A ./ 5040 + (1 + 3 .* A) ./ C;
% C5 = 1./90 + 5 .* A ./ 1008 - (1 + A).^3 ./ C;
% C6 = 1./120 + 17 .* A ./ 5040 + 1 ./ C;
% C7 = 215./2772 + 51 .* A ./ 1232 + (120 + 225 .* A + 150 .* A.^2 + 35 .* A.^3) ./ 14 ./ C;
% C8 = 31./6930 + 128./45045 .* A + (66 + 165 .* A + 132 .* A.^2 + 35 .* A.^3) ./ 77 ./ C;
% C9 = 533./30240 + 653./73920 .* A + (42 + 198 .* A + 117 .* A.^2 + 25 .* A.^3) ./ 84 ./ C;
% C10 = 29./3780 + 3 .* A ./ 704 - (42 + 198 .* A + 243 .* A.^2 + 91 .* A.^3) ./ 84 ./ C;
% C11 = 31./6048 + 1763 .* A ./ 665280 + (42 + 72 .* A + 45 .* A.^2 + 10 .* A.^3) ./ 84 ./ C;
% C12 = 1./2925 + 71 .* A ./ 300300 + (88 + 198 .* A + 156 .* A.^2 + 42 .* A.^3) ./ 385 ./ C;
% C13 = 761./831600 + 937 .* A ./ 1663200 + (2 + 12 .* A + 11 .* A.^2 + 3 .* A.^3) ./ 70 ./ C;
% C14 = 197./415800 + 103 .* A ./ 332640 - (2 + 12 .* A + 17 .* A.^2 + 7 .* A.^3) ./ 70 ./ C;
% C15 = 233./831600 + 97 .* A ./ 554400 + (6 + 18 .* A + 15 .* A.^2 + 4 .* A.^3) ./ 210 ./ C;
% C16 = C1 .* C7 .* C12 + C2 .* C8 .* C3 + C3 .* C8 .* C2 - (C3.^2 .* C7 + C8.^2 .* C1 + C2.^2 .* C12);
% C17 = (C4 .* C7 .* C12 + C2 .* C8 .* C13 + C3 .* C8 .* C9 - (C13 .* C7 .* C3 + C8.^2 .* C4 + C12 .* C2 .* C9)) ./ C16;
% C18 = (C5 .* C7 .* C12 + C2 .* C8 .* C14 + C3 .* C8 .* C10 - (C14 .* C7 .* C3 + C8.^2 .* C5 + C12 .* C2 .* C10)) ./ C16;
% C19 = (C6 .* C7 .* C12 + C2 .* C8 .* C15 + C3 .* C8 .* C11 - (C15 .* C7 .* C3 + C8.^2 .* C6 + C12 .* C2 .* C11)) ./ C16;
% C20 = (C1 .* C9 .* C12 + C4 .* C8 .* C3 + C3 .* C13 .* C2 - (C3.^2 .* C9 + C13 .* C8 .* C1 + C12 .* C4 .* C2)) ./ C16;
% C21 = (C1 .* C10 .* C12 + C5 .* C8 .* C3 + C3 .* C14 .* C2 - (C3.^2 .* C10 + C14 .* C8 .* C1 + C12 .* C5 .* C2)) ./ C16;
% C22 = (C1 .* C11 .* C12 + C6 .* C8 .* C3 + C3 .* C15 .* C2 - (C3.^2 .* C11 + C15 .* C8 .* C1 + C12 .* C6 .* C2)) ./ C16;
% C23 = (C1 .* C7 .* C13 + C2 .* C9 .* C3 + C4 .* C8 .* C2 - (C3 .* C7 .* C4 + C8 .* C9 .* C1 + C2.^2 .* C13)) ./ C16;
% C24 = (C1 .* C7 .* C14 + C2 .* C10 .* C3 + C5 .* C8 .* C2 - (C3 .* C7 .* C5 + C8 .* C10 .* C1 + C2.^2 .* C14)) ./ C16;
% C25 = (C1 .* C7 .* C15 + C2 .* C11 .* C3 + C6 .* C8 .* C2 - (C3 .* C7 .* C6 + C8 .* C11 .* C1 + C2.^2 .* C15)) ./ C16;
% C26 = -(C ./ 4).^(1./4);
% C27 = C20 - C17 - 5./12 + C17 .* C26;
% C28 = C22 - C19 - 1./12 + C19 .* C26;
% C29 = -(C ./ 4).^(1./2);
% C30 = -(C ./ 4).^(3./4);
% C31 = 3 .* A ./ 2 - C17 .* C30;
% C32 = 1./2 - C19 .* C30;
% C33 = (C26 .* C32) ./ 2 + C28 .* C31 .* C29 - (C30 .* C28 ./ 2 + C32 .* C27 .* C29);
% C34 = 1./12 + C18 - C21 - C18 .* C26;
% C35 = C18 .* C30;
% C36 = (C28 .* C35 .* C29 - C32 .* C34 .* C29) ./ C33;
% C37 = ((C26 .* C35) ./ 2 + C34 .* C31 .* C29 - (C30 .* C34) ./ 2 - C35 .* C27 .* C29) ./ C33;
% E1 = C17 .* C36 + C18 + C19 .* C37;
% E2 = C20 .* C36 + C21 + C22 .* C37;
% E3 = C23 .* C36 + C24 + C25 .* C37;
% E4 = (3 + C37 + 3 .* C36) ./ 12 - (2 .* E3 + 15 .* E2 + 10 .* E1) ./ 10;
% E5 = E1 .* ((3 + A) ./ 6) + E2 .* ((21 + 11 .* A) ./ 84) + E3 .* ((3 + 2 .* A) ./ 210);
% E6 = E5 - C36 .* (7./120 + A./36 + 3 .* A ./ C) - 1./40 - A./72 - C37 .* (1./60 + A./120 + 1 ./ C);

%% BY CHATGPT (UNI)
C1 = (1./3) + (A./12);
C2 = (5./42) + (17.*A./336);
C3 = (1./210) + (A./360);
C4 = (11./360) + (59.*A./5040) + ((1 + 3.*A)./C);
C5 = (1./90) + (5.*A./1008) - ((1 + A).^3 ./ C);
C6 = (1./120) + (17.*A./5040) + (1./C);

C7 = (215./2772)    + (51.*A./1232)     + ((120 + 225.*A + 150.*A.^2 + 35.*A.^3) ./ 14) .* (1./C);
C8 = (31./6930)     + (128.*A./45045)   + ((66  + 165.*A + 132.*A.^2 + 35.*A.^3) ./ 77) .* (1./C);
C9 = (533./30240)   + (653.*A./73920)   + ((42  + 198.*A + 117.*A.^2 + 25.*A.^3) ./ 84) .* (1./C);
C10 = (29./3780)    + (3.*A./704)       - ((42  + 198.*A + 243.*A.^2 + 91.*A.^3) ./ 84) .* (1./C);
C11 = (31./6048)    + (1763.*A./665280) + ((42  + 72.*A  + 45.*A.^2  + 10.*A.^3) ./ 84) .* (1./C);
C12 = (1./2925)     + (71.*A./300300)   + ((88  + 198.*A + 156.*A.^2 + 42.*A.^3) ./ 385) .* (1./C);
C13 = (761./831600) + (937.*A./1663200) + ((2   + 12.*A  + 11.*A.^2  + 3.*A.^3) ./ 70) .* (1./C);
C14 = (197./415800) + (103.*A./332640)  - ((2   + 12.*A  + 17.*A.^2  + 7.*A.^3) ./ 70) .* (1./C);
C15 = (233./831600) + (97.*A./554400)   + ((6   + 18.*A  + 15.*A.^2  + 4.*A.^3) ./ 210) .* (1./C);

C16 = C1.*C7.*C12   + C2.*C8.*C3  + C3.*C8.*C2  - (C3.^2.*C7   + C8.^2.*C1   + C2.^2.*C12);
C17 = (C4.*C7.*C12  + C2.*C8.*C13 + C3.*C8.*C9  - (C13.*C7.*C3 + C8.^2.*C4   + C12.*C2.*C9)) .* (1./C16);
C18 = (C5.*C7.*C12  + C2.*C8.*C14 + C3.*C8.*C10 - (C14.*C7.*C3 + C8.^2.*C5   + C12.*C2.*C10)) .* (1./C16);
C19 = (C6.*C7.*C12  + C2.*C8.*C15 + C3.*C8.*C11 - (C15.*C7.*C3 + C8.^2.*C6   + C12.*C2.*C11)) .* (1./C16);
C20 = (C1.*C9.*C12  + C4.*C8.*C3  + C3.*C13.*C2 - (C3.^2.*C9   + C13.*C8.*C1 + C12.*C4.*C2)) .* (1./C16);
C21 = (C1.*C10.*C12 + C5.*C8.*C3  + C3.*C14.*C2 - (C3.^2.*C10  + C14.*C8.*C1 + C12.*C5.*C2)) .* (1./C16);
C22 = (C1.*C11.*C12 + C6.*C8.*C3  + C3.*C15.*C2 - (C3.^2.*C11  + C15.*C8.*C1 + C12.*C6.*C2)) .* (1./C16);
C23 = (C1.*C7.*C13  + C2.*C9.*C3  + C4.*C8.*C2  - (C3.*C7.*C4  + C8.*C9.*C1  + C2.^2.*C13)) .* (1 ./ C16);
C24 = (C1.*C7.*C14  + C2.*C10.*C3 + C5.*C8.*C2  - (C3.*C7.*C5  + C8.*C10.*C1 + C2.^2.*C14)) .* (1 ./ C16);
C25 = (C1.*C7.*C15  + C2.*C11.*C3 + C6.*C8.*C2  - (C3.*C7.*C6  + C8.*C11.*C1 + C2.^2.*C15)) .* (1 ./ C16);

C26 = -(C ./ 4).^(1./4);
C27 = C20 - C17 - 5./12 + C17.*C26;
C28 = C22 - C19 - 1./12 + C19.*C26;
C29 = -(C ./ 4).^(1./2);
C30 = -(C ./ 4).^(3./4);
C31 = (3.*A./2) - C17.*C30;
C32 = (1./2) - C19.*C30;

C33 = (C26.*C32 ./ 2) + C28.*C31.*C29 - ((C30.*C28 ./ 2) + C32.*C27.*C29);
C34 = (1./12) + C18 - C21 - C18.*C26;
C35 = C18.*C30;
C36 = (C28.*C35.*C29 - C32.*C34.*C29) .* (1 ./ C33);

C37 = ((C26.*C35 ./ 2) + C34.*C31.*C29 - (C30.*C34 ./ 2) - C35.*C27.*C29) .* (1 ./ C33);

% Compute E values
E1 = C17.*C36 + C18 + C19.*C37;
E2 = C20.*C36 + C21 + C22.*C37;
E3 = C23.*C36 + C24 + C25.*C37;
E4 = ((3 + C37 + 3.*C36) ./ 12) - ((2.*E3 + 15.*E2 + 10.*E1) ./ 10);

E5 = E1 .* ((3 + A) ./ 6) + E2 .* ((21 + 11.*A) ./ 84) + E3 .* ((3 + 2.*A) ./ 210);

E6 = E5 - C36 .* ((7./120) + (A./36) + (3.*A./C)) - (1./40) - (A./72) - C37 .* ((1./60) + (A./120) + (1./C));


betaF = -E6./((C./(3.*(1-v.^2))).^0.25.*(1+A).^3./C);
betaV = E4./((3.*(1-v.^2)./C).^0.25.*(1+A).^3);

phi = C36./(1+A);

end